description: Cortex XDR Test Playbook
id: Test XDR Playbook
inputs: []
name: Test XDR Playbook
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd8bd558-b5ef-4e3c-8065-1ab83b5f1c51
      iscommand: false
      name: ""
      version: -1
    taskid: fd8bd558-b5ef-4e3c-8065-1ab83b5f1c51
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 50
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8bb6f951-8547-4b60-8ffa-c807d2b23c69
      iscommand: true
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8bb6f951-8547-4b60-8ffa-c807d2b23c69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 195
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      gte_modification_time: {}
      incident_id_list: {}
      limit:
        simple: "3"
      lte_creation_time: {}
      lte_modification_time: {}
      page: {}
      since_creation_time: {}
      since_modification_time: {}
      sort_by_creation_time:
        simple: asc
      sort_by_modification_time: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cb3dc5e1-f48b-45d3-8940-8017f99e1194
      iscommand: true
      name: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      version: -1
    taskid: cb3dc5e1-f48b-45d3-8940-8017f99e1194
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 370
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.status
          operator: isNotEmpty
      label: "yes"
    id: "3"
    ignoreworker: false
    nexttasks:
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e4c64f65-105f-409e-8dc6-7d14f8ad6f3b
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: e4c64f65-105f-409e-8dc6-7d14f8ad6f3b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 545
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      alerts_limit: {}
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d7ff5abe-df5c-4aa6-861f-ec525cd06f71
      iscommand: true
      name: xdr-get-incident-extra-data
      script: '|||xdr-get-incident-extra-data'
      type: regular
      version: -1
    taskid: d7ff5abe-df5c-4aa6-861f-ec525cd06f71
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 720
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      assigned_user_mail: {}
      assigned_user_pretty_name: {}
      incident_id:
        complex:
          accessor: Incident.incident_id
          root: PaloAltoNetworksXDR
          transformers:
          - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      resolve_comment: {}
      status:
        simple: UNDER_INVESTIGATION
      unassign_user: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9fc133c0-42c8-4746-8d6a-917a8f810c2c
      iscommand: true
      name: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      version: -1
    taskid: 9fc133c0-42c8-4746-8d6a-917a8f810c2c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1070
        }
      }
  "7":
    id: "7"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      event_timestampt: {}
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e474972d-4f6f-4004-80e7-11b9899e632c
      iscommand: true
      name: xdr-insert-parsed-alert
      script: '|||xdr-insert-parsed-alert'
      type: regular
      version: -1
    taskid: e474972d-4f6f-4004-80e7-11b9899e632c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2120
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1d65c534-04b0-4ad9-87fd-678b060365f3
      iscommand: true
      name: xdr-insert-cef-alerts
      script: '|||xdr-insert-cef-alerts'
      type: regular
      version: -1
    taskid: 1d65c534-04b0-4ad9-87fd-678b060365f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2470
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 983fdbc3-c4a4-46a6-8f73-bbfb0dedd9bd
      iscommand: true
      name: xdr-isolate-endpoint
      script: '|||xdr-isolate-endpoint'
      type: regular
      version: -1
    taskid: 983fdbc3-c4a4-46a6-8f73-bbfb0dedd9bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 140b12ba-318e-48e9-854e-592f462742fa
      iscommand: true
      name: xdr-unisolate-endpoint
      script: '|||xdr-unisolate-endpoint'
      type: regular
      version: -1
    taskid: 140b12ba-318e-48e9-854e-592f462742fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3170
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list: {}
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8e81c1f0-4336-411a-8309-8e12df508e55
      iscommand: true
      name: xdr-get-endpoints
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: 8e81c1f0-4336-411a-8309-8e12df508e55
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3490
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Endpoint.os_type
          operator: isEqualString
          right:
            value:
              simple: AGENT_OS_LINUX
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Endpoint.ip
          operator: isNotEmpty
      label: "yes"
    id: "12"
    ignoreworker: false
    nexttasks:
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 747f7660-9b66-4d84-8b60-9f95b5a35230
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 747f7660-9b66-4d84-8b60-9f95b5a35230
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3665
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0777b7e0-8f8d-4ace-88d6-96175aaecba5
      iscommand: true
      name: xdr-get-distribution-versions
      script: '|||xdr-get-distribution-versions'
      type: regular
      version: -1
    taskid: 0777b7e0-8f8d-4ace-88d6-96175aaecba5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3840
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.windows
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.linux
          operator: isNotEmpty
      label: "yes"
    id: "14"
    ignoreworker: false
    nexttasks:
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c85e4ad5-38c6-4404-8ed1-5e7f24220fc9
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: c85e4ad5-38c6-4404-8ed1-5e7f24220fc9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4015
        }
      }
  "15":
    id: "15"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      agent_version:
        complex:
          accessor: DistributionVersions.linux
          root: PaloAltoNetworksXDR
          transformers:
          - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c71e70d7-9896-4a54-8a44-ecb8d8c7348e
      iscommand: true
      name: xdr-create-distribution
      script: '|||xdr-create-distribution'
      type: regular
      version: -1
    taskid: c71e70d7-9896-4a54-8a44-ecb8d8c7348e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4190
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Distribution.id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Distribution.platform
          operator: isExists
      label: "yes"
    id: "16"
    ignoreworker: false
    nexttasks:
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3274772-bf16-49ea-8ca2-bd416bab8409
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: f3274772-bf16-49ea-8ca2-bd416bab8409
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4365
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a22877f5-8f64-4cb2-8417-b7fc698e2ce2
      iscommand: true
      name: xdr-get-distribution-url
      script: '|||xdr-get-distribution-url'
      type: regular
      version: -1
    taskid: a22877f5-8f64-4cb2-8417-b7fc698e2ce2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4890
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Distribution.url
          operator: isNotEmpty
      label: "yes"
    id: "18"
    ignoreworker: false
    nexttasks:
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d43c9959-e9c3-4049-820c-16139c883843
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: d43c9959-e9c3-4049-820c-16139c883843
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5065
        }
      }
  "19":
    id: "19"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dbde960d-19a9-427f-8896-7fda47e97d13
      iscommand: true
      name: xdr-get-create-distribution-status
      script: '|||xdr-get-create-distribution-status'
      type: regular
      version: -1
    taskid: dbde960d-19a9-427f-8896-7fda47e97d13
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4540
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
          operator: isEqualString
          right:
            value:
              simple: Completed
        - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
          operator: isEqualString
          right:
            value:
              simple: In Progress
      label: "yes"
    id: "20"
    ignoreworker: false
    nexttasks:
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1763298e-215e-4004-8e2f-0754b2ee4f7f
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 1763298e-215e-4004-8e2f-0754b2ee4f7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4715
        }
      }
  "21":
    id: "21"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      email: {}
      limit:
        simple: "5"
      page: {}
      result: {}
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
      timestamp_lte: {}
      type: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a7136f8-79dc-4014-8929-c51ec88b30b3
      iscommand: true
      name: xdr-get-audit-management-logs
      script: '|||xdr-get-audit-management-logs'
      type: regular
      version: -1
    taskid: 2a7136f8-79dc-4014-8929-c51ec88b30b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5240
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
          operator: containsGeneral
          right:
            value:
              simple: Authentication failed
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
          operator: isNotEmpty
      label: "yes"
    id: "22"
    ignoreworker: false
    nexttasks:
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12f24b5c-bac1-4fb9-8927-56e395e29a67
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 12f24b5c-bac1-4fb9-8927-56e395e29a67
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5415
        }
      }
  "23":
    id: "23"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_ids: {}
      endpoint_names:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      limit:
        simple: "5"
      page: {}
      result:
        simple: Success
      sort_by:
        simple: category
      sort_order:
        simple: desc
      sub_type: {}
      timestamp_gte:
        simple: "2019-10-10"
      timestamp_lte: {}
      type: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1c6c528b-3a83-4991-85a0-9b32655f9638
      iscommand: true
      name: xdr-get-audit-agent-reports
      script: '|||xdr-get-audit-agent-reports'
      type: regular
      version: -1
    taskid: 1c6c528b-3a83-4991-85a0-9b32655f9638
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5590
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
          operator: containsGeneral
          right:
            value:
              simple: ip-172-31-15-237.eu-central-1.compute.internal
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
          operator: isNotEmpty
      label: "yes"
    id: "24"
    ignoreworker: false
    nexttasks:
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e035d694-ac71-4c44-8f5c-e61e13bbdccd
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: e035d694-ac71-4c44-8f5c-e61e13bbdccd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5765
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f37cf51e-b894-4639-8e06-f79396f6f8f5
      iscommand: false
      name: Test Done
      type: title
      version: -1
    taskid: f37cf51e-b894-4639-8e06-f79396f6f8f5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6290
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.manual_severity
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.status
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.alerts.alert_id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.alerts.source
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.network_artifacts.network_remote_ip
          operator: isNotEmpty
      label: "yes"
    id: "26"
    ignoreworker: false
    nexttasks:
      "yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f526736-aacf-4976-8470-6c4ca2b73343
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 9f526736-aacf-4976-8470-6c4ca2b73343
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 895
        }
      }
  "27":
    id: "27"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: XDRIncidentID
      value:
        complex:
          accessor: Incident.incident_id
          root: PaloAltoNetworksXDR
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5fe3acf9-3946-4a3f-8923-2606c890485f
      iscommand: false
      name: Save incident id
      script: Set
      type: regular
      version: -1
    taskid: 5fe3acf9-3946-4a3f-8923-2606c890485f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1245
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep:
        simple: XDRIncidentID
      subplaybook: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0a6f27da-5a54-4245-812b-35ea421d2e9a
      iscommand: false
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: 0a6f27da-5a54-4245-812b-35ea421d2e9a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1420
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      gte_creation_time: {}
      gte_modification_time: {}
      incident_id_list:
        simple: ${XDRIncidentID}
      limit: {}
      lte_creation_time: {}
      lte_modification_time: {}
      page: {}
      since_creation_time: {}
      since_modification_time: {}
      sort_by_creation_time:
        simple: desc
      sort_by_modification_time: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa57f300-08cd-4164-8474-ce3e1946f1df
      iscommand: true
      name: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      version: -1
    taskid: aa57f300-08cd-4164-8474-ce3e1946f1df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1595
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
          operator: isEqualString
          right:
            value:
              simple: high
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Incident.status
          operator: isEqualString
          right:
            value:
              simple: under_investigation
      label: "yes"
    id: "30"
    ignoreworker: false
    nexttasks:
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 666ef98c-e358-47f3-80cf-c6025d6ee7c3
      iscommand: false
      name: Verify updated values
      type: condition
      version: -1
    taskid: 666ef98c-e358-47f3-80cf-c6025d6ee7c3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1770
        }
      }
  "31":
    id: "31"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      assigned_user_mail: {}
      assigned_user_pretty_name: {}
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      resolve_comment: {}
      status:
        simple: NEW
      unassign_user: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7ff2df84-2c98-49d3-8aff-0832b019da8b
      iscommand: true
      name: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      version: -1
    taskid: 7ff2df84-2c98-49d3-8aff-0832b019da8b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1945
        }
      }
  "32":
    id: "32"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05197bae-0549-47c6-8f4a-bb33dfbe08fc
      iscommand: false
      name: Set 2 CEF alerts to context
      script: Set
      type: regular
      version: -1
    taskid: 05197bae-0549-47c6-8f4a-bb33dfbe08fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2295
        }
      }
  "33":
    id: "33"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list:
        simple: f8a2f58846b542579c12090652e79f3d
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      id: 1b96679f-0992-481c-82b2-227e95f582b6
      iscommand: true
      name: Get Endpoint f8a2f58846b542579c12090652e79f3d
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: 1b96679f-0992-481c-82b2-227e95f582b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2645
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
          operator: isEqualString
          right:
            value:
              simple: AGENT_UNISOLATED
      label: "yes"
    id: "34"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d627b141-6f4c-4928-87ce-8cc184d0690f
      iscommand: false
      name: To isolate ?
      type: condition
      version: -1
    taskid: d627b141-6f4c-4928-87ce-8cc184d0690f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2820
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
          operator: isEqualString
          right:
            value:
              simple: AGENT_ISOLATED
      label: "yes"
    id: "35"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 844dfdbf-49f2-4911-875b-24294587a2a2
      iscommand: false
      name: To unisolate?
      type: condition
      version: -1
    taskid: 844dfdbf-49f2-4911-875b-24294587a2a2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2995
        }
      }
  "36":
    id: "36"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92120c5c-7ad2-4bab-8da0-173506068f28
      iscommand: false
      name: Isolation done
      type: title
      version: -1
    taskid: 92120c5c-7ad2-4bab-8da0-173506068f28
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
  "37":
    id: "37"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list: {}
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters it will return all endpoints. Filtering by multiple fields
        will be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      id: 02ed4821-c1d1-4387-83b6-f722f2a6b94c
      iscommand: true
      name: xdr-get-endpoints
      script: Cortex XDR - IR|||xdr-get-endpoints
      type: regular
      version: -1
    taskid: 02ed4821-c1d1-4387-83b6-f722f2a6b94c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5940
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PaloAltoNetworksXDR.Endpoint
          operator: hasLength
          right:
            value:
              simple: "3"
      label: "yes"
    id: "38"
    ignoreworker: false
    nexttasks:
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ffacf444-8535-465a-8029-5070ecf01873
      iscommand: false
      name: Check the number of endpoints in context
      type: condition
      version: -1
    taskid: ffacf444-8535-465a-8029-5070ecf01873
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6115
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 6305,
        "width": 922.5,
        "x": 50,
        "y": 50
      }
    }
  }
fromversion: 4.1.0
